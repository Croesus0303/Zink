# Zink – AI Task Challenge App

## Project Overview

**Zink** is a cross-platform mobile application (iOS & Android) that sends users creative challenges every 6 hours, generated by OpenAI. Users have 2 hours to submit a photo related to the challenge. Submissions, likes, and comments are displayed in a public feed.

## Core Features

- **Cross-platform:** iOS & Android (Flutter)
- **Authentication:** Google & iCloud via Firebase Authentication
- **AI-generated Content:** Task prompt (OpenAI GPT-4o) & reference image (DALL·E 3)
- **Push Notifications:** Firebase Cloud Messaging (FCM) – Every 6 hours (00:00, 06:00, 12:00, 18:00 UTC)
- **Submission Options:** Use device camera or upload from gallery
- **Challenge Feed:** Filter by Most Popular / Newest / Oldest
- **Archived Events:** View previous challenges and their submissions
- **User Profiles:** Profile photo, username, social media links, challenge history
- **Localization:** Turkish & English (via `flutter_intl`, ARB files)

## Technology Stack

| Layer             | Tech                                      | Description                                         |
| ----------------- | ----------------------------------------- | --------------------------------------------------- |
| **Client**        | Flutter 3.x, Dart                         | UI & state management (**Riverpod 3**)              |
| **Backend**       | Firebase                                  | Auth, Firestore, Storage, Likes, Comments, Profiles |
| **AI Service**    | FastAPI (Python) + OpenAI API             | Challenge generation, image creation & push trigger |
| **Notifications** | Firebase Cloud Messaging (via FastAPI)    | Triggered by external backend every 6 hours         |
| **CI/CD**         | GitHub Actions, Firebase App Distribution | Automated test & deployment pipelines               |

| Layer          | Tech                                      | Description                                                     |
| -------------- | ----------------------------------------- | --------------------------------------------------------------- |
| **Client**     | Flutter 3.x, Dart                         | UI & state management (**Riverpod 3**)                          |
| **Backend**    | Firebase                                  | Auth, Firestore, Storage, Cloud Functions, Cloud Scheduler, FCM |
| **AI Service** | OpenAI (GPT-4o & DALL·E 3)                | Text & image generation                                         |
| **CI/CD**      | GitHub Actions, Firebase App Distribution | Automated test & deployment pipelines                           |

## User Flows

1. **App Launch → Authentication**
   - Google or iCloud sign-in
2. **Home View**
   - List of past events
   - Latest notification challenge highlighted
3. **Notification → Event Detail View**
   - Challenge description & reference image
   - Submission feed (popular / new / old filters)
   - Comments & likes
   - "Submit Photo" button
4. **Photo Submission**
   - Take photo or upload from gallery
   - Preview and submit
5. **Profile View**
   - Profile picture, social media links
   - Grid view of participated challenges

## Firestore Data Model

```text
users (uid)
  displayName
  photoURL
  socialLinks {instagram, twitter, …}
  createdAt

events (eventId)
  title
  description
  referenceImageURL
  startTime (Timestamp)
  endTime (Timestamp)       // +2h

submissions (eventId, uid)
  imageURL
  createdAt
  likeCount

comments (submissionId, commentId)
  uid
  text
  createdAt

likes (submissionId, uid)   // presence = like
```

## External Event Trigger Service (FastAPI)

The FastAPI-based backend handles event generation and notification delivery. It supports both scheduled automation and manual invocation for testing purposes.

| Endpoint                    | Trigger                                   | Description                                                                  |
| --------------------------- | ----------------------------------------- | ---------------------------------------------------------------------------- |
| **POST /generate-event**    | Manual (for testing) & cron (prod)        | Sends prompt to OpenAI, generates reference image, stores event in Firestore |
| **POST /send-notification** | Triggered internally after event creation | Pushes FCM notification to all users about the new challenge                 |

**Scheduling:** The FastAPI service is configured with an internal scheduler (e.g., APScheduler or cronjob runner) that triggers `/generate-event` every 6 hours (00:00, 06:00, 12:00, 18:00 UTC). For development/testing, this endpoint can also be manually invoked.

This service fully replaces the previous Firebase Cloud Function–based event scheduler.

| Function              | Trigger                                          | Description                                                                        |
| --------------------- | ------------------------------------------------ | ---------------------------------------------------------------------------------- |
| ~~**generateEvent**~~ | Cloud Scheduler (00:00, 06:00, 12:00, 18:00 UTC) | Sends prompt to OpenAI, generates image, creates event doc, sends FCM notification |
| **updateLikeCount**   | Firestore trigger (likes)                        | Atomically updates `submissions.likeCount`                                         |
| **cleanOldEvents**    | Optional                                         | Archives or deletes old events                                                     |

## Security Rules (Draft)

- Only authenticated users can create `submissions`, `comments`, or `likes`
- Users can only modify their own profile
- Like counts handled by Firebase. Event creation and notifications are managed externally via FastAPI.

## UI/UX Design Notes

- **Theme:** Modern & minimal with light/dark mode support
- **Localization:** `flutter_intl` with Turkish & English support via ARB files
- **Reference Image:** Thumbnail in notification, full-screen in detail view
- **State Management:** Riverpod with hooks & code generation
- **Accessibility:** Dynamic Type, alt-text support, proper color contrast
- **Color Palette:** #8DD5F2, #F2CB9B, #F25C05, #F23005, #8C0303
- **Logo:** v1 (see logo_v1.png)

## Testing Plan

- **Unit Tests:** Data models and business logic
- **Widget Tests:** Home, EventDetail, Profile
- **Integration Tests:** Login → Notification → Submission → Like flow

## CI/CD Pipeline

1. On Pull Request → run `flutter test`
2. Build commands: `flutter build apk --release` & `flutter build ipa`
3. Firebase App Distribution to internal testers
4. Git tag triggers production release (App Store & Play Store)
